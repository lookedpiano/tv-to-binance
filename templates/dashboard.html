<!DOCTYPE html>
<html>
    <head>
        <title>Binance Cache Dashboard</title>
        <link rel="icon" type="image/png" href="{{ url_for('static', filename='bitcoin_fav.png') }}">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
        <script src="{{ url_for('static', filename='dashboard.js') }}"></script>
    </head>
    <body>
        <h1>
            <span class="white-part">Binance</span>
            <span class="orange-part">Cache Dashboard</span>
        </h1>

        <div class="tables-row">
            <div class="table-card">
                <h2>System Status</h2>
                <div id="system-status-content"></div>
                <div class="card-footer">
                    <button onclick="refreshSystemStatus()">Get System Status</button>
                </div>
            </div>
            
            <div class="table-card">
                <h2>Filters</h2>
                <p>Total cached filters: {{ filters_count }}</p>
                <div class="card-footer">
                    <p class="time">Last refreshed: <b>{{ last_filters }}</b></p>
                    <button onclick="refresh('filters')">Refresh Filters</button>
                </div>
            </div>
        </div>

        <div class="tables-row">
            <div class="table-card">
                <h2>Balances</h2>
                <p>Total cached balances: {{ balances|length }}</p>
                <table>
                    <tr><th>Asset</th><th>Free</th></tr>
                    {% for asset, amount in balances.items() %}
                        <tr><td>{{ asset }}</td><td>{{ amount }}</td></tr>
                    {% endfor %}
                </table>
                <div class="card-footer">
                    <p class="time">Last refreshed: <b>{{ last_balances }}</b></p>
                    <button onclick="refresh('balances')">Refresh Balances</button>
                </div>
            </div>

            <div class="table-card">
                <h2>Prices</h2>
                <p>Total cached prices: {{ prices|length }}</p>
                <table>
                    <tr><th>Symbol</th><th>Price</th></tr>
                    {% for symbol, price in prices.items() %}
                        <tr><td>{{ symbol }}</td><td>{{ price }}</td></tr>
                    {% endfor %}
                </table>
                <div class="card-footer">
                    <p class="time">Last updated: <b>{{ last_prices }}</b></p>
                    <button onclick="refresh('prices')">Refresh Prices</button>
                </div>
            </div>
        </div>

        <div id="overlay">
            <div id="overlay-box">
                <div class="spinner"></div>
                <p id="overlay-text">Please waitâ€¦</p>
            </div>
        </div>
    </body>
</html>
